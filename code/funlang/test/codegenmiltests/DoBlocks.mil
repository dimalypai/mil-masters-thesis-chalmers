main : (IO ::: Id) Unit =
  let (_ : Unit) <- printString "Hello from main" in
    let (i : Int) <- readInt in
      let (_ : Unit) <- printInt i in
        let (f : Float) <- readFloat in
          let (_ : Unit) <- printFloat f in
            let (v : Int) <- lift [Id -> IO ::: Id] execState [Int] [Unit] stateManip 1 in
              let (_ : Unit) <- printInt v in
                lift [Id -> IO ::: Id] evalState [Int] [Unit] stateManip 0;

stateManip : Int -> Id {Unit, Int} =
  \(state1 : Int) -> let (i : Int) <- return [Id] state1 in
                       let (state2 : Int) <- return [Id] i in
                         return [Id] {unit, (\(s : Int) -> s) state2};

execState : forall S . forall A . (S -> Id {A, S}) -> S -> Id S =
  /\S . /\A . \(f : S -> Id {A, S}) -> \(s : S) -> let (res : {A, S}) <- f s in
                                                     case res of
                                                       | {a : A, s1 : S} => return [Id] s1
                                                     end;

evalState : forall S . forall A . (S -> Id {A, S}) -> S -> Id A =
  /\S . /\A . \(f : S -> Id {A, S}) -> \(s : S) -> let (res : {A, S}) <- f s in
                                                     case res of
                                                       | {a : A, s1 : S} => return [Id] a
                                                     end;

