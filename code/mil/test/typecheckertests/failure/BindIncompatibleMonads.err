MIL type checking error: The expression needs to operate in the 'State' monad, but it operates in the 'IO' monad
